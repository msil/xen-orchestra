// @flow

import base64url from 'base64url'
import { fromCallback } from 'promise-toolbox'
import { randomBytes } from 'crypto'

const generateSecureToken = (bytes: number = 32): Promise<string> =>
  fromCallback(cb => randomBytes(bytes, cb)).then(base64url)

export { generateSecureToken as default }
